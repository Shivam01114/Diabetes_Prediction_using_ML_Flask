<!DOCTYPE html>
<html>
<head>
<title>Dashboard</title>
<link rel="stylesheet" href="/static/css/style.css">

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<!-- Your chart logic -->
<script src="/static/js/charts.js"></script>

<style>
/* GRID FIX */
.dashboard-grid{
    display:grid;
    grid-template-columns:repeat(4,1fr);
    gap:18px;
    margin-top:25px;
}

.metric-card{
    background:#03150f;
    border:1px solid rgba(0,255,156,.35);
    border-radius:16px;
    padding:18px;
    text-align:center;
    box-shadow:0 0 18px rgba(0,255,156,.18);
}

.metric-card h4{
    color:#00ff9c;
    margin-bottom:8px;
    font-size:14px;
}

.metric-card .value{
    font-size:22px;
    font-weight:600;
}

.metric-card .status{
    margin-top:6px;
    font-size:13px;
    opacity:.9;
}
</style>
</head>

<body>

<div class="dashboard">

<!-- SIDEBAR -->
<div class="sidebar">
<h2>Diabetes AI</h2>
<ul>
<li onclick="location.href='/'">Overview</li>
<li class="active">Dashboard</li>
<li onclick="location.href='/decision'">AI Decision</li>
<li onclick="location.href='/diet'">Diet</li>
<li onclick="location.href='/reports'">Reports</li>
</ul>
</div>

<!-- MAIN -->
<div class="main-content">
<h1>游늵 Patient Dashboard</h1>

<!-- CHART BOX -->
<div class="info-box">
    <canvas id="vitalsChart"></canvas>
</div>

<!-- METRICS -->
<div class="dashboard-grid">

<div class="metric-card">
<h4>Pregnancies</h4>
<div class="value">{{ patient.Pregnancies or 0 }}</div>
<div class="status">Count</div>
</div>

<div class="metric-card">
<h4>Glucose</h4>
<div class="value">{{ patient.Glucose or 0 }}</div>
<div class="status">
{% if patient.Glucose|int >= 126 %}游댮 High
{% elif patient.Glucose|int >= 100 %}游리 Borderline
{% else %}游릭 Normal
{% endif %}
</div>
</div>

<div class="metric-card">
<h4>Blood Pressure</h4>
<div class="value">{{ patient.BloodPressure or 0 }}</div>
<div class="status">
{% if patient.BloodPressure|int >= 140 %}游댮 High
{% elif patient.BloodPressure|int >= 120 %}游리 Elevated
{% else %}游릭 Normal
{% endif %}
</div>
</div>

<div class="metric-card">
<h4>Skin Thickness</h4>
<div class="value">{{ patient.SkinThickness or 0 }}</div>
<div class="status">Body Fat</div>
</div>

<div class="metric-card">
<h4>Insulin</h4>
<div class="value">{{ patient.Insulin or 0 }}</div>
<div class="status">Hormone</div>
</div>

<div class="metric-card">
<h4>BMI</h4>
<div class="value">{{ patient.BMI or 0 }}</div>
<div class="status">
{% if patient.BMI|float >= 30 %}游댮 Obese
{% elif patient.BMI|float >= 25 %}游리 Overweight
{% else %}游릭 Healthy
{% endif %}
</div>
</div>

<div class="metric-card">
<h4>DPF</h4>
<div class="value">{{ patient.DiabetesPedigreeFunction or 0 }}</div>
<div class="status">Genetic Risk</div>
</div>

<div class="metric-card">
<h4>Age</h4>
<div class="value">{{ patient.Age or 0 }}</div>
<div class="status">Years</div>
</div>

</div>

</div>
</div>

<!-- IMPORTANT: INIT + UPDATE CHART AFTER PAGE LOAD -->
<script>
document.addEventListener("DOMContentLoaded", function(){

    // ensure chart is created
    initChart();

    // update with patient values
    updateChartFromInputs([
        {{patient.Pregnancies or 0}},
        {{patient.Glucose or 0}},
        {{patient.BloodPressure or 0}},
        {{patient.SkinThickness or 0}},
        {{patient.Insulin or 0}},
        {{patient.BMI or 0}},
        {{patient.DiabetesPedigreeFunction or 0}},
        {{patient.Age or 0}}
    ]);
});
</script>

</body>
</html>
